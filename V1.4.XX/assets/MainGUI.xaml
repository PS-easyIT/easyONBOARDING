<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="{Binding APPName}"
    Width="1270"
    Height="875"
    Background="#F5F5F5"
    ResizeMode="NoResize"
    SizeToContent="Manual"
    WindowStartupLocation="CenterScreen">
    <!--  Define reusable styles with INI property bindings  -->
    <Window.Resources>
        <!--  Windows 11 inspired styles  -->
        <Style x:Key="StandardButton" TargetType="Button">
            <Setter Property="Height" Value="40" />
            <Setter Property="Margin" Value="5" />
            <Setter Property="Padding" Value="16,0" />
            <Setter Property="Background" Value="#FFFFFF" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
            <Setter Property="Foreground" Value="#202020" />
            <Setter Property="FontFamily" Value="{Binding DefaultFontFamily}" />
            <Setter Property="FontSize" Value="{Binding DefaultFontSize}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F2F2F2" />
                    <Setter Property="BorderBrush" Value="#D0D0D0" />
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#E6E6E6" />
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.6" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style
            x:Key="ActionButton"
            BasedOn="{StaticResource StandardButton}"
            TargetType="Button">
            <Setter Property="Width" Value="225" />
        </Style>

        <Style
            x:Key="SquareButton"
            BasedOn="{StaticResource StandardButton}"
            TargetType="Button">
            <Setter Property="Width" Value="50" />
            <Setter Property="Height" Value="50" />
            <Setter Property="Margin" Value="5" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="StandardTextBlock" TargetType="TextBlock">
            <Setter Property="Margin" Value="0,0,5,0" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontFamily" Value="{Binding DefaultFontFamily}" />
            <Setter Property="FontSize" Value="{Binding DefaultFontSize}" />
            <Setter Property="Foreground" Value="#202020" />
        </Style>

        <Style x:Key="StandardTextBox" TargetType="TextBox">
            <Setter Property="Margin" Value="5" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontFamily" Value="{Binding DefaultFontFamily}" />
            <Setter Property="FontSize" Value="{Binding DefaultFontSize}" />
            <Setter Property="Background" Value="White" />
            <Setter Property="Foreground" Value="#202020" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="8,6" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TextBox}">
                        <Border
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4">
                            <ScrollViewer x:Name="PART_ContentHost" Margin="0" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="#BDBDBD" />
                </Trigger>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="#0078D4" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <!--  Stil für Pflichtfelder mit rotem Rahmen  -->
        <Style
            x:Key="RequiredTextBox"
            BasedOn="{StaticResource StandardTextBox}"
            TargetType="TextBox">
            <Style.Triggers>
                <Trigger Property="Text" Value="">
                    <Setter Property="BorderBrush" Value="#E81123" />
                    <Setter Property="BorderThickness" Value="1" />
                    <Setter Property="ToolTip" Value="Dieses Feld ist erforderlich!" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="GroupBoxStyle" TargetType="GroupBox">
            <Setter Property="Margin" Value="0,0,0,10" />
            <Setter Property="Padding" Value="12" />
            <Setter Property="Background" Value="#FFFFFF" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
            <Setter Property="Foreground" Value="#202020" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="GroupBox">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="Transparent">
                                <ContentPresenter
                                    Margin="8,0,0,0"
                                    ContentSource="Header"
                                    RecognizesAccessKey="True" />
                            </Border>
                            <Border
                                Grid.Row="1"
                                Margin="0,5,0,0"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8">
                                <ContentPresenter Margin="{TemplateBinding Padding}" />
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="TabControlStyle" TargetType="TabControl">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="TabStripPlacement" Value="Top" />
            <Setter Property="Visibility" Value="Visible" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabControl">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <Border
                                Grid.Row="0"
                                Panel.ZIndex="1"
                                Background="Transparent">
                                <TabPanel IsItemsHost="True" KeyboardNavigation.TabIndex="1" />
                            </Border>
                            <Border
                                Grid.Row="1"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="0,1,0,0"
                                CornerRadius="0,0,8,8">
                                <ContentPresenter
                                    x:Name="PART_SelectedContentHost"
                                    Margin="0"
                                    ContentSource="SelectedContent" />
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="TabItemStyle" TargetType="TabItem">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="#505050" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Margin" Value="2,2,2,0" />
            <Setter Property="Padding" Value="16,10" />
            <Setter Property="Height" Value="40" />
            <Setter Property="MinWidth" Value="120" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border
                            x:Name="Border"
                            Margin="{TemplateBinding Margin}"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="0,0,0,3"
                            CornerRadius="4,4,0,0">
                            <ContentPresenter
                                x:Name="ContentSite"
                                Margin="{TemplateBinding Padding}"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                ContentSource="Header" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#F8F8F8" />
                                <Setter TargetName="Border" Property="BorderBrush" Value="#0078D4" />
                                <Setter Property="Foreground" Value="#0078D4" />
                                <Setter Property="FontWeight" Value="SemiBold" />
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#F2F2F2" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="StandardComboBox" TargetType="ComboBox">
            <Setter Property="Margin" Value="5" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontFamily" Value="{Binding DefaultFontFamily}" />
            <Setter Property="FontSize" Value="{Binding DefaultFontSize}" />
            <Setter Property="Background" Value="White" />
            <Setter Property="Foreground" Value="#202020" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="8,6" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton
                                x:Name="ToggleButton"
                                ClickMode="Press"
                                IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}">
                                <ToggleButton.Template>
                                    <ControlTemplate TargetType="ToggleButton">
                                        <Border
                                            x:Name="ToggleBorder"
                                            Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="{TemplateBinding BorderThickness}"
                                            CornerRadius="4">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition />
                                                    <ColumnDefinition Width="30" />
                                                </Grid.ColumnDefinitions>
                                                <ContentPresenter
                                                    Grid.Column="0"
                                                    Margin="8,0,0,0"
                                                    HorizontalAlignment="Left"
                                                    VerticalAlignment="Center" />
                                                <Path
                                                    x:Name="Arrow"
                                                    Grid.Column="1"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    Data="M0,0 L6,6 L12,0"
                                                    Fill="#505050"
                                                    Stroke="#505050"
                                                    StrokeThickness="1" />
                                            </Grid>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="ToggleBorder" Property="Background" Value="#F8F8F8" />
                                                <Setter TargetName="ToggleBorder" Property="BorderBrush" Value="#BDBDBD" />
                                            </Trigger>
                                            <Trigger Property="IsChecked" Value="True">
                                                <Setter TargetName="ToggleBorder" Property="BorderBrush" Value="#0078D4" />
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </ToggleButton.Template>
                            </ToggleButton>
                            <ContentPresenter
                                x:Name="ContentSite"
                                Margin="8,0,30,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Content="{TemplateBinding SelectionBoxItem}"
                                ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}" />
                            <Popup
                                x:Name="Popup"
                                AllowsTransparency="True"
                                IsOpen="{TemplateBinding IsDropDownOpen}"
                                Placement="Bottom"
                                PopupAnimation="Fade">
                                <Border
                                    x:Name="DropDownBorder"
                                    MinWidth="{TemplateBinding ActualWidth}"
                                    MaxHeight="{TemplateBinding MaxDropDownHeight}"
                                    Background="White"
                                    BorderBrush="#E0E0E0"
                                    BorderThickness="1"
                                    CornerRadius="4">
                                    <ScrollViewer SnapsToDevicePixels="True">
                                        <ItemsPresenter KeyboardNavigation.DirectionalNavigation="Contained" />
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="#BDBDBD" />
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.6" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <!--  Stil für Pflichtfeld-ComboBox mit rotem Rahmen  -->
        <Style
            x:Key="RequiredComboBox"
            BasedOn="{StaticResource StandardComboBox}"
            TargetType="ComboBox">
            <Style.Triggers>
                <Trigger Property="SelectedIndex" Value="-1">
                    <Setter Property="BorderBrush" Value="#E81123" />
                    <Setter Property="BorderThickness" Value="1" />
                    <Setter Property="ToolTip" Value="Dieses Feld ist erforderlich!" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="StandardCheckBox" TargetType="CheckBox">
            <Setter Property="Margin" Value="5" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontFamily" Value="{Binding DefaultFontFamily}" />
            <Setter Property="FontSize" Value="{Binding DefaultFontSize}" />
            <Setter Property="Foreground" Value="#202020" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="20" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Border
                                x:Name="checkBoxBorder"
                                Width="18"
                                Height="18"
                                VerticalAlignment="Center"
                                Background="White"
                                BorderBrush="#737373"
                                BorderThickness="1"
                                CornerRadius="2">
                                <Path
                                    x:Name="checkMark"
                                    Margin="2"
                                    Data="M 2,7 L 7,12 L 12,3"
                                    Fill="#0078D4"
                                    Stretch="Uniform"
                                    Stroke="#0078D4"
                                    StrokeThickness="2"
                                    Visibility="Collapsed" />
                            </Border>
                            <ContentPresenter
                                Grid.Column="1"
                                Margin="8,0,0,0"
                                VerticalAlignment="Center" />
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="true">
                                <Setter TargetName="checkMark" Property="Visibility" Value="Visible" />
                                <Setter TargetName="checkBoxBorder" Property="BorderBrush" Value="#0078D4" />
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="checkBoxBorder" Property="BorderBrush" Value="#0078D4" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter TargetName="checkBoxBorder" Property="Opacity" Value="0.55" />
                                <Setter TargetName="checkMark" Property="Opacity" Value="0.55" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="StandardRadioButton" TargetType="RadioButton">
            <Setter Property="Margin" Value="5" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontFamily" Value="{Binding DefaultFontFamily}" />
            <Setter Property="FontSize" Value="{Binding DefaultFontSize}" />
            <Setter Property="Foreground" Value="#202020" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="20" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Ellipse
                                x:Name="radioButtonBorder"
                                Width="18"
                                Height="18"
                                VerticalAlignment="Center"
                                Fill="White"
                                Stroke="#737373"
                                StrokeThickness="1" />
                            <Ellipse
                                x:Name="radioButtonMark"
                                Width="10"
                                Height="10"
                                VerticalAlignment="Center"
                                Fill="#0078D4"
                                Visibility="Collapsed" />
                            <ContentPresenter
                                Grid.Column="1"
                                Margin="8,0,0,0"
                                VerticalAlignment="Center" />
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="true">
                                <Setter TargetName="radioButtonMark" Property="Visibility" Value="Visible" />
                                <Setter TargetName="radioButtonBorder" Property="Stroke" Value="#0078D4" />
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="radioButtonBorder" Property="Stroke" Value="#0078D4" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter TargetName="radioButtonBorder" Property="Opacity" Value="0.55" />
                                <Setter TargetName="radioButtonMark" Property="Opacity" Value="0.55" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="DataGridStyle" TargetType="DataGrid">
            <Setter Property="Background" Value="White" />
            <Setter Property="AlternatingRowBackground" Value="#F8F8F8" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
            <Setter Property="HorizontalGridLinesBrush" Value="#E0E0E0" />
            <Setter Property="VerticalGridLinesBrush" Value="#E0E0E0" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="{Binding FontSize}" />
            <Setter Property="RowHeight" Value="36" />
            <Setter Property="ColumnHeaderHeight" Value="40" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="RowHeaderWidth" Value="0" />
            <Setter Property="HeadersVisibility" Value="Column" />
        </Style>

        <Style x:Key="ListViewStyle" TargetType="ListView">
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="{Binding FontSize}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListView">
                        <Border
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4">
                            <ScrollViewer Style="{DynamicResource ScrollViewerStyle}">
                                <ItemsPresenter />
                            </ScrollViewer>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ScrollViewerStyle" TargetType="ScrollViewer">
            <Setter Property="VerticalScrollBarVisibility" Value="Auto" />
            <Setter Property="HorizontalScrollBarVisibility" Value="Auto" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollViewer">
                        <Grid Background="{TemplateBinding Background}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <ScrollContentPresenter Grid.Row="0" Grid.Column="0" />

                            <ScrollBar
                                x:Name="PART_VerticalScrollBar"
                                Grid.Row="0"
                                Grid.Column="1"
                                Maximum="{TemplateBinding ScrollableHeight}"
                                ViewportSize="{TemplateBinding ViewportHeight}"
                                Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
                                Value="{TemplateBinding VerticalOffset}" />

                            <ScrollBar
                                x:Name="PART_HorizontalScrollBar"
                                Grid.Row="1"
                                Grid.Column="0"
                                Maximum="{TemplateBinding ScrollableWidth}"
                                Orientation="Horizontal"
                                ViewportSize="{TemplateBinding ViewportWidth}"
                                Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"
                                Value="{TemplateBinding HorizontalOffset}" />
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ProgressBarStyle" TargetType="ProgressBar">
            <Setter Property="Height" Value="20" />
            <Setter Property="Margin" Value="0,5,0,5" />
            <Setter Property="Foreground" Value="#4CAF50" />
            <Setter Property="Background" Value="#F5F5F5" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ProgressBar">
                        <Border
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4">
                            <Grid x:Name="PART_Track">
                                <Rectangle
                                    x:Name="PART_Indicator"
                                    HorizontalAlignment="Left"
                                    Fill="{TemplateBinding Foreground}"
                                    RadiusX="4"
                                    RadiusY="4" />
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  Icon Converter und andere Ressourcen  -->
        <Style x:Key="SafeImageStyle" TargetType="Image">
            <Setter Property="RenderOptions.BitmapScalingMode" Value="HighQuality" />
            <Style.Triggers>
                <EventTrigger RoutedEvent="Image.ImageFailed">
                    <BeginStoryboard>
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="{x:Static Visibility.Collapsed}" />
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
            </Style.Triggers>
        </Style>

        <DrawingImage x:Key="PlaceholderIcon">
            <DrawingImage.Drawing>
                <GeometryDrawing Brush="#BDBDBD">
                    <GeometryDrawing.Geometry>
                        <RectangleGeometry
                            RadiusX="4"
                            RadiusY="4"
                            Rect="0,0,32,32" />
                    </GeometryDrawing.Geometry>
                </GeometryDrawing>
            </DrawingImage.Drawing>
        </DrawingImage>

        <!--  Tab-Icons als Platzhalter für die einzelnen Tabs  -->
        <DrawingImage x:Key="OnboardingIcon">
            <DrawingImage.Drawing>
                <GeometryDrawing Brush="#0078D4">
                    <GeometryDrawing.Geometry>
                        <RectangleGeometry
                            RadiusX="3"
                            RadiusY="3"
                            Rect="0,0,16,16" />
                    </GeometryDrawing.Geometry>
                </GeometryDrawing>
            </DrawingImage.Drawing>
        </DrawingImage>

        <DrawingImage x:Key="ADUpdateIcon">
            <DrawingImage.Drawing>
                <GeometryDrawing Brush="#4CAF50">
                    <GeometryDrawing.Geometry>
                        <RectangleGeometry
                            RadiusX="3"
                            RadiusY="3"
                            Rect="0,0,16,16" />
                    </GeometryDrawing.Geometry>
                </GeometryDrawing>
            </DrawingImage.Drawing>
        </DrawingImage>

        <DrawingImage x:Key="CSVImportIcon">
            <DrawingImage.Drawing>
                <GeometryDrawing Brush="#FF9800">
                    <GeometryDrawing.Geometry>
                        <RectangleGeometry
                            RadiusX="3"
                            RadiusY="3"
                            Rect="0,0,16,16" />
                    </GeometryDrawing.Geometry>
                </GeometryDrawing>
            </DrawingImage.Drawing>
        </DrawingImage>

        <DrawingImage x:Key="JiraConfluenceIcon">
            <DrawingImage.Drawing>
                <GeometryDrawing Brush="#9C27B0">
                    <GeometryDrawing.Geometry>
                        <RectangleGeometry
                            RadiusX="3"
                            RadiusY="3"
                            Rect="0,0,16,16" />
                    </GeometryDrawing.Geometry>
                </GeometryDrawing>
            </DrawingImage.Drawing>
        </DrawingImage>

        <DrawingImage x:Key="INIEditorIcon">
            <DrawingImage.Drawing>
                <GeometryDrawing Brush="#F44336">
                    <GeometryDrawing.Geometry>
                        <RectangleGeometry
                            RadiusX="3"
                            RadiusY="3"
                            Rect="0,0,16,16" />
                    </GeometryDrawing.Geometry>
                </GeometryDrawing>
            </DrawingImage.Drawing>
        </DrawingImage>

        <Style x:Key="DatePickerStyle" TargetType="DatePicker">
            <Setter Property="Margin" Value="5" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontFamily" Value="{Binding DefaultFontFamily}" />
            <Setter Property="FontSize" Value="{Binding DefaultFontSize}" />
            <Setter Property="Background" Value="White" />
            <Setter Property="Foreground" Value="#202020" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="8,6" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DatePicker">
                        <Grid>
                            <Border
                                Padding="8,0"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <DatePickerTextBox
                                        x:Name="PART_TextBox"
                                        Grid.Column="0"
                                        Padding="0"
                                        HorizontalContentAlignment="Left"
                                        VerticalContentAlignment="Center"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        FontFamily="{TemplateBinding FontFamily}"
                                        FontSize="{TemplateBinding FontSize}"
                                        FontStretch="{TemplateBinding FontStretch}"
                                        FontStyle="{TemplateBinding FontStyle}"
                                        FontWeight="{TemplateBinding FontWeight}"
                                        Foreground="{TemplateBinding Foreground}" />
                                    <Button
                                        x:Name="PART_Button"
                                        Grid.Column="1"
                                        Width="20"
                                        Height="20"
                                        Margin="5,0,0,0"
                                        VerticalAlignment="Center"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Focusable="False">
                                        <Path
                                            Width="12"
                                            Height="12"
                                            Data="M19,4H18V2H16V4H8V2H6V4H5A2,2 0 0,0 3,6V20A2,2 0 0,0 5,22H19A2,2 0 0,0 21,20V6A2,2 0 0,0 19,4M19,20H5V10H19V20M19,8H5V6H19V8Z"
                                            Fill="#505050"
                                            Stretch="Uniform" />
                                    </Button>
                                </Grid>
                            </Border>
                            <Popup
                                x:Name="PART_Popup"
                                AllowsTransparency="True"
                                PlacementTarget="{Binding ElementName=PART_Button}"
                                StaysOpen="False">
                                <Border
                                    Background="White"
                                    BorderBrush="#E0E0E0"
                                    BorderThickness="1"
                                    CornerRadius="4">
                                    <Calendar
                                        x:Name="PART_Calendar"
                                        Background="Transparent"
                                        BorderThickness="0" />
                                </Border>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="#BDBDBD" />
                </Trigger>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="#0078D4" />
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <!--  Hauptcontainer: Grid, der den TabControl-Bereich umschließt  -->
    <Grid Background="#FFEEEEEE">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="55" /> <!-- Platz für Buttons am unteren Rand -->
        </Grid.RowDefinitions>

        <!-- TabControl für die Hauptbereiche -->
        <TabControl
            x:Name="MainTabControl"
            Grid.Row="0"
            Margin="10,10,10,0"
            Style="{StaticResource TabControlStyle}">

            <!-- TAB 1: Benutzerdaten -->
            <TabItem x:Name="Tab_UserData" Style="{StaticResource TabItemStyle}">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <Rectangle Width="16" Height="15" Margin="0,0,8,0" Fill="#0078D4" RadiusX="3" RadiusY="3" />
                        <TextBlock FontSize="14" FontWeight="SemiBold" Text="Benutzerdaten" />
                    </StackPanel>
                </TabItem.Header>
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <!-- OU Selection Box -->
                        <Border Height="Auto" Margin="5" Background="#FFFFEFEF" BorderBrush="LightGray" BorderThickness="1" CornerRadius="8">
                            <StackPanel Margin="5" Orientation="Vertical">
                                <TextBlock FontWeight="Bold" Text="Organisatorische Einheit (OU)" Margin="0,0,0,5" />
                                <!-- OU Auswahl -->
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <ComboBox x:Name="cmbOU" Grid.Column="0" MinWidth="200" Style="{StaticResource RequiredComboBox}" ToolTip="Wählen Sie die OU aus, in der der Benutzer erstellt werden soll." TabIndex="1"/>
                                    <Button x:Name="btnRefreshOU" Grid.Column="1" Height="30" Width="80" Margin="10,0,0,0" Content="Refresh" Style="{StaticResource StandardButton}" ToolTip="Lädt die OUs neu." TabIndex="2"/>
                                </Grid>
                                <!-- Abteilungsauswahl -->
                                <TextBlock FontWeight="Bold" Text="Abteilung" Margin="0,10,0,5" />
                                <Grid Margin="5">
                                     <ComboBox x:Name="cmbDepartment" MinWidth="200" Style="{StaticResource RequiredComboBox}" ToolTip="Wählen Sie die Abteilung des Benutzers aus." TabIndex="3"/>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- User Basic Information Box -->
                        <Border Height="Auto" Margin="5" Background="#FFEEEEEE" BorderBrush="LightGray" BorderThickness="1" CornerRadius="8">
                            <StackPanel Margin="10" Orientation="Vertical">
                                <TextBlock FontSize="12" FontWeight="Bold" Text="Basisinformationen" Margin="0,0,0,10" TextDecorations="Underline" />
                                <!-- First Name -->
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Style="{StaticResource StandardTextBlock}" Text="Vorname *:" />
                                    <TextBox x:Name="txtFirstName" Grid.Column="1" Style="{StaticResource RequiredTextBox}" ToolTip="Geben Sie den Vornamen ein." TabIndex="4"/>
                                </Grid>
                                <!-- Last Name -->
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Style="{StaticResource StandardTextBlock}" Text="Nachname *:" />
                                    <TextBox x:Name="txtLastName" Grid.Column="1" Style="{StaticResource RequiredTextBox}" ToolTip="Geben Sie den Nachnamen ein." TabIndex="5"/>
                                </Grid>
                                <!-- External Employee Checkbox -->
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Style="{StaticResource StandardTextBlock}" Text="Externer Mitarbeiter?" />
                                    <CheckBox x:Name="chkExternal" Grid.Column="1" Style="{StaticResource StandardCheckBox}" ToolTip="Aktivieren, wenn es sich um einen externen Mitarbeiter handelt." TabIndex="6"/>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Display Name Box -->
                        <Border Height="Auto" Margin="5" Background="#FFEEEEEE" BorderBrush="LightGray" BorderThickness="1" CornerRadius="8">
                            <StackPanel Margin="10" Orientation="Vertical">
                                <TextBlock FontSize="12" FontWeight="Bold" Text="Anzeigeeinstellungen" Margin="0,0,0,10" TextDecorations="Underline" />
                                <!-- Display Name -->
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Style="{StaticResource StandardTextBlock}" Text="Anzeigename:" />
                                    <TextBox x:Name="txtDisplayName" Grid.Column="1" Style="{StaticResource StandardTextBox}" ToolTip="Der Anzeigename des Benutzers (wird oft automatisch generiert)." TabIndex="7" IsReadOnly="True" Background="#F0F0F0"/>
                                </Grid>
                                <!-- UPN Template Auswahl -->
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Style="{StaticResource StandardTextBlock}" Text="Namens-Vorlage *:" />
                                    <ComboBox x:Name="cmbDisplayTemplate" Grid.Column="1" Style="{StaticResource RequiredComboBox}" ToolTip="Wählen Sie die Vorlage für den Anzeigenamen und UPN." TabIndex="8">
                                        <!-- Items werden aus der INI geladen -->
                                    </ComboBox>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Additional Information Box -->
                        <Border Height="Auto" Margin="5,10,5,5" Background="#FFEEEEEE" BorderBrush="LightGray" BorderThickness="1" CornerRadius="8">
                            <StackPanel Margin="10" Orientation="Vertical">
                                <TextBlock FontSize="12" FontWeight="Bold" Text="Zusätzliche Informationen" Margin="0,0,0,10" TextDecorations="Underline" />
                                <!-- Description (Ticket ID + Text) -->
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Style="{StaticResource StandardTextBlock}" Text="Beschreibung:" />
                                    <Grid Grid.Column="1">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" /> <!-- Ticket ID -->
                                            <ColumnDefinition Width="*" /> <!-- Description Text -->
                                        </Grid.ColumnDefinitions>
                                        <TextBox x:Name="txtDescriptionNumber" Grid.Column="0" Width="90" Margin="0,0,5,0" Style="{StaticResource StandardTextBox}" ToolTip="Geben Sie die Ticket-ID ein (optional)." TabIndex="9" />
                                        <TextBox x:Name="txtDescription" Grid.Column="1" Style="{StaticResource StandardTextBox}" ToolTip="Geben Sie eine kurze Beschreibung ein (optional)." TabIndex="10" />
                                    </Grid>
                                </Grid>
                                <!-- Office -->
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Style="{StaticResource StandardTextBlock}" Text="Büro/Standort:" />
                                    <TextBox x:Name="txtOffice" Grid.Column="1" Style="{StaticResource StandardTextBox}" ToolTip="Geben Sie das Büro oder den Standort ein." TabIndex="11" />
                                </Grid>
                                <!-- Phone -->
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Style="{StaticResource StandardTextBlock}" Text="Telefonnummer:" />
                                    <TextBox x:Name="txtPhone" Grid.Column="1" Style="{StaticResource StandardTextBox}" ToolTip="Geben Sie die geschäftliche Telefonnummer ein." TabIndex="12" />
                                </Grid>
                                <!-- Mobile -->
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Style="{StaticResource StandardTextBlock}" Text="Mobiltelefon:" />
                                    <TextBox x:Name="txtMobile" Grid.Column="1" Style="{StaticResource StandardTextBox}" ToolTip="Geben Sie die Mobiltelefonnummer ein (optional)." TabIndex="13" />
                                </Grid>
                                <!-- Position -->
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Style="{StaticResource StandardTextBlock}" Text="Position/Titel:" />
                                    <TextBox x:Name="txtPosition" Grid.Column="1" Style="{StaticResource StandardTextBox}" ToolTip="Geben Sie die Position oder den Titel des Benutzers ein." TabIndex="14" />
                                </Grid>
                                <!-- Department (Textfeld, da Abteilung oben ausgewählt wird) -->
                                <Grid Margin="5">
                                     <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Style="{StaticResource StandardTextBlock}" Text="Abteilung (AD):" />
                                    <TextBox x:Name="txtDepartmentAD" Grid.Column="1" Style="{StaticResource StandardTextBox}" ToolTip="Die Abteilung, wie sie im AD angezeigt wird (oft aus der Auswahl oben übernommen)." TabIndex="15" IsReadOnly="True" Background="#F0F0F0"/>
                                </Grid>
                                <!-- Termination Date -->
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Style="{StaticResource StandardTextBlock}" Text="Austrittsdatum:" />
                                    <DatePicker x:Name="datTermination" Grid.Column="1" Style="{StaticResource DatePickerStyle}" ToolTip="Geben Sie das Austrittsdatum ein (leer lassen, wenn unbefristet). Wird nur bei deaktiviertem Konto wirksam." TabIndex="16" />
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Email Address Box -->
                        <Border Height="Auto" Margin="5" Background="#FFEEEEEE" BorderBrush="LightGray" BorderThickness="1" CornerRadius="8">
                             <StackPanel Margin="10" Orientation="Vertical">
                                 <TextBlock FontSize="12" FontWeight="Bold" Text="E-Mail Konfiguration" Margin="0,0,0,10" TextDecorations="Underline" />
                                 <Grid Margin="5">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="120"/>
                                         <ColumnDefinition Width="*"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Style="{StaticResource StandardTextBlock}" Text="Mail-Präfix:"/>
                                     <TextBox x:Name="txtEmailPrefix" Grid.Column="1" Style="{StaticResource StandardTextBox}" ToolTip="Der Teil der E-Mail-Adresse vor dem @ (wird oft automatisch generiert)." TabIndex="17" IsReadOnly="True" Background="#F0F0F0"/>
                                 </Grid>
                                 <Grid Margin="5">
                                     <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Style="{StaticResource StandardTextBlock}" Text="Mail-Suffix *:"/>
                                     <ComboBox x:Name="cmbSuffix" Grid.Column="1" Style="{StaticResource RequiredComboBox}" DisplayMemberPath="Value" ItemsSource="{Binding MailSuffixListFromINI}" SelectedValuePath="Key" ToolTip="Wählen Sie die E-Mail-Domäne aus." TabIndex="18"/>
                                 </Grid>
                                 <Grid Margin="5">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="120"/>
                                         <ColumnDefinition Width="*"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Style="{StaticResource StandardTextBlock}" Text="E-Mail Adresse:"/>
                                     <TextBox x:Name="txtEmail" Grid.Column="1" Style="{StaticResource StandardTextBox}" ToolTip="Die vollständige E-Mail-Adresse (wird automatisch generiert)." TabIndex="19" IsReadOnly="True" Background="#F0F0F0"/>
                                 </Grid>
                             </StackPanel>
                        </Border>
                        <Border Height="18" Background="Transparent" /> <!-- Spacer -->
                         <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                            <Button x:Name="btnImportCSV" Width="120" Height="30" Margin="0,0,15,0" Background="AntiqueWhite" Content="Import CSV" TabIndex="30" ToolTip="Öffnet einen Dialog zur Auswahl einer CSV-Datei für den Massenimport.">
                                <Button.Template>
                                    <ControlTemplate TargetType="{x:Type Button}">
                                        <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="8">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                            <Button x:Name="btnClearForm" Width="120" Height="30" Background="LightGray" Content="Formular leeren" TabIndex="31" ToolTip="Setzt alle Felder im Formular zurück.">
                                <Button.Template>
                                    <ControlTemplate TargetType="{x:Type Button}">
                                        <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="8">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- TAB 2: Einstellungen & Gruppen -->
            <TabItem x:Name="Tab_SettingsGroups" Style="{StaticResource TabItemStyle}">
                 <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <Rectangle Width="16" Height="15" Margin="0,0,8,0" Fill="#4CAF50" RadiusX="3" RadiusY="3" />
                        <TextBlock FontSize="14" FontWeight="SemiBold" Text="Einstellungen &amp; Gruppen" />
                    </StackPanel>
                </TabItem.Header>
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <!-- Linkes Panel (Einstellungen) -->
                        <ColumnDefinition Width="*" />
                        <!-- Rechtes Panel (Aktionen & Logo) -->
                        <ColumnDefinition Width="300" />
                    </Grid.ColumnDefinitions>

                    <!-- Linkes Panel: Einstellungen und Gruppen -->
                     <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="0,0,10,0">
                            <!-- Account Status & Role Assignment -->
                            <Grid Margin="0,0,0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <!-- Left Box: Account Status -->
                                <Border Grid.Column="0" Margin="0,0,5,0" Background="#FFEEEEEE" BorderBrush="LightGray" BorderThickness="1" CornerRadius="8">
                                    <StackPanel Margin="10" Orientation="Vertical">
                                        <TextBlock FontSize="12" FontWeight="Bold" Text="Kontostatus" TextDecorations="Underline" />
                                        <RadioButton x:Name="rbAccountEnabled" Margin="10,10,0,5" Content="Konto Aktiviert" FontSize="12" GroupName="AccountStatus" TabIndex="20" ToolTip="Das Benutzerkonto wird aktiviert erstellt."/>
                                        <RadioButton x:Name="rbAccountDisabled" Margin="10,5,0,5" Content="Konto Deaktiviert" FontSize="12" GroupName="AccountStatus" IsChecked="True" TabIndex="21" ToolTip="Das Benutzerkonto wird deaktiviert erstellt (Standard)."/>
                                    </StackPanel>
                                </Border>
                                <!-- Right Box: Role Assignment (TL/AL) -->
                                <Border Grid.Column="1" Margin="5,0,0,0" Background="#FFEEEEEE" BorderBrush="LightGray" BorderThickness="1" CornerRadius="8">
                                     <StackPanel Margin="10">
                                         <TextBlock Margin="0,0,0,5" FontSize="12" FontWeight="Bold" Text="Rollen Zuweisung" TextDecorations="Underline" />
                                         <!-- TL/AL Checkboxes -->
                                         <StackPanel Margin="0,5,0,5" Orientation="Horizontal">
                                            <CheckBox x:Name="chkTL" Margin="0,0,15,0" VerticalAlignment="Center" Content="Team Lead (TL)" FontSize="11" FontWeight="SemiBold" TabIndex="22" ToolTip="Weist die ausgewählte Teamleiter-Gruppe zu."/>
                                            <CheckBox x:Name="chkAL" VerticalAlignment="Center" Content="Abteilungsleiter (AL)" FontSize="11" FontWeight="SemiBold" TabIndex="23" ToolTip="Weist die Abteilungsleiter-Gruppe zu."/>
                                         </StackPanel>
                                         <!-- TL Group Selection -->
                                         <Grid Margin="0,5,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Style="{StaticResource StandardTextBlock}" Text="TL Gruppe:" />
                                            <ComboBox x:Name="cmbTLGroup" Grid.Column="1" Height="30" MinWidth="150" Margin="10,0,0,0" Style="{StaticResource StandardComboBox}" DisplayMemberPath="Value" ItemsSource="{Binding TLGroupOptions}" SelectedValuePath="Value" IsEnabled="{Binding IsChecked, ElementName=chkTL}" TabIndex="24" ToolTip="Wählen Sie die spezifische Teamleiter-Gruppe aus."/>
                                         </Grid>
                                    </StackPanel>
                                </Border>
                            </Grid>

                            <!-- Password Options Section -->
                            <Border Margin="0,5,0,5" Background="#FFEEEEEE" BorderBrush="LightGray" BorderThickness="1" CornerRadius="8">
                                <StackPanel Orientation="Vertical">
                                    <TextBlock Margin="10,10,0,5" FontSize="12" FontWeight="Bold" Text="Passwort Optionen" TextDecorations="Underline" />
                                    <Grid Margin="10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <!-- Left Box: GENERATED Password -->
                                        <Border Grid.Column="0" Margin="0,0,5,0" Background="#FFFBFBFB" BorderBrush="LightGray" BorderThickness="1" CornerRadius="6">
                                            <StackPanel Margin="10" Orientation="Vertical">
                                                <RadioButton x:Name="rbRand" Content="Generiertes Passwort" FontWeight="SemiBold" GroupName="PasswordOption" IsChecked="True" Style="{StaticResource StandardRadioButton}" TabIndex="25" ToolTip="Es wird ein zufälliges Passwort generiert."/>
                                                <Grid Margin="10,5,0,0">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Style="{StaticResource StandardTextBlock}" Text="Länge:" />
                                                    <TextBox x:Name="txtPWLen" Grid.Column="1" Width="40" Margin="5,0,0,0" Style="{StaticResource StandardTextBox}" Text="14" TabIndex="26" ToolTip="Länge des generierten Passworts."/>
                                                </Grid>
                                                <CheckBox x:Name="chkIncludeSpecial" Margin="10,5,0,0" Content="Sonderzeichen" FontSize="11" IsChecked="True" Style="{StaticResource StandardCheckBox}" TabIndex="27" ToolTip="Schließt Sonderzeichen in das Passwort ein."/>
                                                <CheckBox x:Name="chkAvoidAmbig" Margin="10,5,0,0" Content="Eindeutige Zeichen" FontSize="11" IsChecked="True" Style="{StaticResource StandardCheckBox}" TabIndex="28" ToolTip="Vermeidet missverständliche Zeichen wie I, l, 1, O, 0."/>
                                            </StackPanel>
                                        </Border>
                                        <!-- Right Box: FIXED Password -->
                                        <Border Grid.Column="1" Margin="5,0,0,0" Background="#FFFBFBFB" BorderBrush="LightGray" BorderThickness="1" CornerRadius="6">
                                            <StackPanel Margin="10" Orientation="Vertical">
                                                <RadioButton x:Name="rbFix" Content="Festes Passwort" FontWeight="SemiBold" GroupName="PasswordOption" Style="{StaticResource StandardRadioButton}" TabIndex="29" ToolTip="Verwendet das unten eingegebene feste Passwort."/>
                                                <TextBox x:Name="txtFixPW" Margin="10,10,0,0" FontSize="12" Style="{StaticResource StandardTextBox}" IsEnabled="{Binding IsChecked, ElementName=rbFix}" ToolTip="Geben Sie das feste Passwort ein."/>
                                            </StackPanel>
                                        </Border>
                                    </Grid>
                                </StackPanel>
                            </Border>

                             <!-- License Selection -->
                            <Border Margin="0,5,0,5" Background="#FFEEEEEE" BorderBrush="LightGray" BorderThickness="1" CornerRadius="8">
                                <StackPanel Margin="10">
                                    <TextBlock Margin="0,0,0,5" FontSize="12" FontWeight="Bold" Text="Lizenz Auswahl" TextDecorations="Underline" />
                                    <Grid Margin="0,5,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Style="{StaticResource StandardTextBlock}" Text="MS365 Lizenz:" />
                                        <ComboBox x:Name="cmbLicense" Grid.Column="1" MinWidth="150" Style="{StaticResource StandardComboBox}" DisplayMemberPath="Name" ItemsSource="{Binding LicenseListFromINI}" SelectedValuePath="Value" TabIndex="32" ToolTip="Wählen Sie die zuzuweisende Microsoft 365 Lizenz aus (optional)."/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- AD Groups Section Box -->
                            <Border Height="350" Margin="0,5,0,15" Background="#FFEEEEEE" BorderBrush="LightGray" BorderThickness="1" CornerRadius="8">
                                <StackPanel Margin="10" Orientation="Vertical">
                                    <TextBlock FontSize="12" FontWeight="Bold" Text="AD Gruppen Zuweisung" Margin="0,0,0,5" TextDecorations="Underline" />
                                    <TextBlock FontSize="10" FontStyle="Italic" Text="(Gruppen werden basierend auf der Abteilung automatisch vorausgewählt)" Margin="0,0,0,10"/>
                                    <ScrollViewer Height="280" Background="#FFFBFBFB" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                                        <ItemsControl x:Name="icADGroups">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <!-- Ändere Columns auf 2 für bessere Lesbarkeit -->
                                                    <UniformGrid Columns="2" />
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                     <!-- Verwende CheckBox Style und setze TabIndex -->
                                                    <CheckBox Margin="5" Content="{Binding Name}" IsChecked="{Binding IsSelected}" Style="{StaticResource StandardCheckBox}" ToolTip="{Binding Tooltip}" TabIndex="33"/>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </ScrollViewer>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                     </ScrollViewer>

                    <!-- Rechtes Panel: Aktionen, Logo etc. -->
                    <Border Grid.Column="1" Margin="5,0,0,0" VerticalAlignment="Stretch" Background="#FFEEEEEE" BorderBrush="LightGray" BorderThickness="1" CornerRadius="8">
                        <StackPanel Margin="16">
                            <!-- Logo und Header -->
                            <StackPanel HorizontalAlignment="Center" Orientation="Vertical" Margin="0,0,0,20">
                                <Image x:Name="picLogo1" Width="150" Height="60" Margin="0,0,0,10" Source="{Binding OnboardingLogo}" Stretch="Uniform" Style="{StaticResource SafeImageStyle}" ToolTip="Firmenlogo"/>
                            </StackPanel>

                            <!-- Reporting Options -->
                            <Border Margin="0,10,0,15" Background="#FFFBFBFB" BorderBrush="LightGray" BorderThickness="1" CornerRadius="8">
                                <StackPanel Margin="10" Orientation="Vertical">
                                    <TextBlock Margin="0,0,0,10" FontWeight="Bold" Text="Reporting" TextDecorations="Underline" />
                                    <Button x:Name="btnUploadLogo" Height="30" Margin="5" Style="{StaticResource StandardButton}" Content="Berichts-Logo ändern" TabIndex="34" ToolTip="Ermöglicht das Hochladen eines Logos für den PDF-Bericht."/>
                                    <Button x:Name="btnPDF" Height="30" Margin="5" Background="#FFDAB9" Style="{StaticResource StandardButton}" Content="PDF Bericht erstellen" TabIndex="35" ToolTip="Erstellt einen PDF-Bericht mit den aktuellen Daten (ohne Benutzeranlage)."/>
                                </StackPanel>
                            </Border>

                            <!-- Spacer -->
                            <Border Height="60" Background="Transparent" />

                            <!-- Progress & Status -->
                            <StackPanel HorizontalAlignment="Center" Orientation="Vertical" Margin="0,20,0,0">
                                <TextBlock Text="Fortschritt:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                <ProgressBar x:Name="progressBar" Width="220" Style="{StaticResource ProgressBarStyle}" ToolTip="Zeigt den Fortschritt der Benutzeranlage an."/>
                                <TextBlock x:Name="lblStatus" Width="220" Margin="0,5,0,0" TextWrapping="Wrap" Text="Bereit" TextAlignment="Center" ToolTip="Zeigt den aktuellen Status an."/>
                             </StackPanel>
                         </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Weitere Tabs können hier hinzugefügt werden -->
            <!-- Beispiel:
            <TabItem x:Name="Tab_ADUpdate" Style="{StaticResource TabItemStyle}">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                         <Image Source="{StaticResource ADUpdateIcon}" Width="16" Height="16" Margin="0,0,8,0"/>
                        <TextBlock Text="AD Update"/>
                    </StackPanel>
                </TabItem.Header>
                <Grid>
                    <TextBlock Text="Inhalt für AD Update Tab" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Grid>
            </TabItem>
            -->

        </TabControl>

        <!-- Untere Button-Leiste -->
        <Border Grid.Row="1" Background="#FFF0F0F0" BorderBrush="#E0E0E0" BorderThickness="0,1,0,0">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,20,0">
                 <Button x:Name="btnPreview" Content="Vorschau" Style="{StaticResource ActionButton}" Width="150" Margin="5" TabIndex="40" ToolTip="Zeigt eine Vorschau der Benutzerdaten an, ohne diese zu erstellen."/>
                 <Button x:Name="btnCreateUser" Content="Benutzer erstellen" Style="{StaticResource ActionButton}" Width="150" Margin="5" Background="#4CAF50" Foreground="White" FontWeight="Bold" TabIndex="41" ToolTip="Startet den Prozess zur Erstellung des Benutzers im Active Directory.">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource ActionButton}">
                            <Setter Property="Background" Value="#4CAF50"/>
                            <Setter Property="Foreground" Value="White"/>
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#45a049"/>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter Property="Background" Value="#3e8e41"/>
                                </Trigger>
                             </Style.Triggers>
                        </Style>
                    </Button.Style>
                 </Button>
                 <Button x:Name="btnClose" Content="Schließen" Style="{StaticResource StandardButton}" Width="100" Margin="15,5,5,5" TabIndex="42" ToolTip="Schließt die Anwendung."/>
            </StackPanel>
        </Border>

        <!-- Platz für das Log-Panel (ursprünglich ganz links) -->
        <!-- Dieses könnte bei Bedarf wieder hinzugefügt oder anders integriert werden -->
        <!--
        <Border Grid.Column="0" Grid.Row="0" Grid.RowSpan="2" Margin="10,10,5,10" Style="{StaticResource LeftPanelStyle}">
             <DockPanel>
                <TextBlock DockPanel.Dock="Top" Text="Logs" FontWeight="Bold" Margin="10"/>
                <TextBox x:Name="txtLogOutput" AcceptsReturn="True" IsReadOnly="True" VerticalScrollBarVisibility="Auto" TextWrapping="Wrap" Margin="10,0,10,10"/>
            </DockPanel>
        </Border>
        -->

    </Grid>
</Window>