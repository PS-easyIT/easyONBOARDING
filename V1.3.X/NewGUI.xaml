<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="{Binding APPName}"
    Width="1268"
    Height="875"
    Background="{Binding ThemeColor}"
    ResizeMode="NoResize"
    SizeToContent="Manual">
    <!--  Define reusable styles with INI property bindings  -->
    <Window.Resources>
        <Style x:Key="StandardButton" TargetType="Button">
            <Setter Property="Height" Value="40" />
            <Setter Property="Margin" Value="5" />
            <Setter Property="Padding" Value="10,0" />
            <Setter Property="Background" Value="{Binding BoxColor}" />
            <Setter Property="BorderBrush" Value="{Binding RahmenColor}" />
            <Setter Property="Foreground" Value="{Binding ButtonTextColor}" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="{Binding ButtonFontSize}" />
        </Style>

        <Style
            x:Key="ActionButton"
            BasedOn="{StaticResource StandardButton}"
            TargetType="Button">
            <Setter Property="Width" Value="225" />
        </Style>

        <Style x:Key="StandardTextBlock" TargetType="TextBlock">
            <Setter Property="Margin" Value="0,0,5,0" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="{Binding FontSize}" />
            <Setter Property="Foreground" Value="{Binding TextColor}" />
        </Style>

        <Style x:Key="StandardTextBox" TargetType="TextBox">
            <Setter Property="Margin" Value="5" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="{Binding FontSize}" />
            <Setter Property="Background" Value="{Binding TextBoxBackgroundColor}" />
            <Setter Property="Foreground" Value="{Binding TextBoxForegroundColor}" />
            <Setter Property="BorderBrush" Value="{Binding TextBoxBorderColor}" />
        </Style>

        <!--  Neuer Stil f체r Pflichtfelder mit rotem Rahmen  -->
        <Style
            x:Key="RequiredTextBox"
            BasedOn="{StaticResource StandardTextBox}"
            TargetType="TextBox">
            <Style.Triggers>
                <Trigger Property="Text" Value="">
                    <Setter Property="BorderBrush" Value="Red" />
                    <Setter Property="BorderThickness" Value="1" />
                    <Setter Property="ToolTip" Value="Dieses Feld ist erforderlich!" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="GroupBoxStyle" TargetType="GroupBox">
            <Setter Property="Margin" Value="0,0,0,10" />
            <Setter Property="Padding" Value="5" />
            <Setter Property="Background" Value="{Binding GroupBoxBackgroundColor}" />
            <Setter Property="BorderBrush" Value="{Binding GroupBoxBorderColor}" />
            <Setter Property="Foreground" Value="{Binding GroupBoxForegroundColor}" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="{Binding GroupBoxFontSize}" />
        </Style>

        <Style x:Key="TabControlStyle" TargetType="TabControl">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderBrush" Value="{Binding RahmenColor}" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="{Binding TabFontSize}" />
            <Setter Property="Padding" Value="2" />
            <Setter Property="TabStripPlacement" Value="Top" />
            <Setter Property="Visibility" Value="Visible" />
        </Style>

        <Style x:Key="TabItemStyle" TargetType="TabItem">
            <Setter Property="Background" Value="{Binding TabItemBackgroundColor}" />
            <Setter Property="Foreground" Value="{Binding TabItemForegroundColor}" />
            <Setter Property="BorderBrush" Value="{Binding TabItemBorderColor}" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="{Binding TabFontSize}" />
            <Setter Property="Margin" Value="1,1,1,0" />
            <Setter Property="Padding" Value="10,5" />
            <Setter Property="Height" Value="30" />
            <Setter Property="MinWidth" Value="100" />
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="{Binding TabItemSelectedBackgroundColor}" />
                    <Setter Property="BorderThickness" Value="1,1,1,0" />
                    <Setter Property="FontWeight" Value="Bold" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="StandardComboBox" TargetType="ComboBox">
            <Setter Property="Margin" Value="5" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="{Binding FontSize}" />
            <Setter Property="Background" Value="{Binding ComboBoxBackgroundColor}" />
            <Setter Property="Foreground" Value="{Binding ComboBoxForegroundColor}" />
            <Setter Property="BorderBrush" Value="{Binding ComboBoxBorderColor}" />
        </Style>

        <!--  Neuer Stil f체r Pflichtfeld-ComboBox mit rotem Rahmen  -->
        <Style
            x:Key="RequiredComboBox"
            BasedOn="{StaticResource StandardComboBox}"
            TargetType="ComboBox">
            <Style.Triggers>
                <Trigger Property="SelectedIndex" Value="-1">
                    <Setter Property="BorderBrush" Value="Red" />
                    <Setter Property="BorderThickness" Value="1" />
                    <Setter Property="ToolTip" Value="Dieses Feld ist erforderlich!" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="StandardCheckBox" TargetType="CheckBox">
            <Setter Property="Margin" Value="5" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="{Binding FontSize}" />
            <Setter Property="Foreground" Value="{Binding TextColor}" />
        </Style>

        <Style x:Key="StandardRadioButton" TargetType="RadioButton">
            <Setter Property="Margin" Value="5" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="{Binding FontSize}" />
            <Setter Property="Foreground" Value="{Binding TextColor}" />
        </Style>

        <Style x:Key="DataGridStyle" TargetType="DataGrid">
            <Setter Property="Background" Value="White" />
            <Setter Property="AlternatingRowBackground" Value="#F0F0F0" />
            <Setter Property="BorderBrush" Value="{Binding GroupBoxBorderColor}" />
            <Setter Property="HorizontalGridLinesBrush" Value="#DDDDDD" />
            <Setter Property="VerticalGridLinesBrush" Value="#DDDDDD" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="{Binding FontSize}" />
        </Style>

        <Style x:Key="ListViewStyle" TargetType="ListView">
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderBrush" Value="{Binding GroupBoxBorderColor}" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="{Binding FontSize}" />
        </Style>

        <Style x:Key="ScrollViewerStyle" TargetType="ScrollViewer">
            <Setter Property="VerticalScrollBarVisibility" Value="Auto" />
            <Setter Property="HorizontalScrollBarVisibility" Value="Auto" />
            <Setter Property="Background" Value="Transparent" />
        </Style>

        <Style x:Key="ProgressBarStyle" TargetType="ProgressBar">
            <Setter Property="Height" Value="20" />
            <Setter Property="Margin" Value="0,5,0,5" />
            <Setter Property="Foreground" Value="#4CAF50" />
            <Setter Property="Background" Value="#E0E0E0" />
            <Setter Property="BorderBrush" Value="#BBBBBB" />
        </Style>

        <!-- Adding styles from MainGUI.xaml -->
        <Style x:Key="SafeImageStyle" TargetType="Image">
            <Setter Property="RenderOptions.BitmapScalingMode" Value="HighQuality" />
            <Style.Triggers>
                <EventTrigger RoutedEvent="Image.ImageFailed">
                    <BeginStoryboard>
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="{x:Static Visibility.Collapsed}"/>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
            </Style.Triggers>
        </Style>

        <DrawingImage x:Key="PlaceholderIcon">
            <DrawingImage.Drawing>
                <GeometryDrawing Brush="Gray">
                    <GeometryDrawing.Geometry>
                        <RectangleGeometry Rect="0,0,32,32" />
                    </GeometryDrawing.Geometry>
                </GeometryDrawing>
            </DrawingImage.Drawing>
        </DrawingImage>

        <DrawingImage x:Key="OnboardingIcon">
            <DrawingImage.Drawing>
                <GeometryDrawing Brush="#4CAF50">
                    <GeometryDrawing.Geometry>
                        <RectangleGeometry RadiusX="5" RadiusY="5" Rect="0,0,32,32" />
                    </GeometryDrawing.Geometry>
                </GeometryDrawing>
            </DrawingImage.Drawing>
        </DrawingImage>

        <DrawingImage x:Key="EinstellungenIcon">
            <DrawingImage.Drawing>
                <GeometryDrawing Brush="#2196F3">
                    <GeometryDrawing.Geometry>
                        <RectangleGeometry RadiusX="5" RadiusY="5" Rect="0,0,32,32" />
                    </GeometryDrawing.Geometry>
                </GeometryDrawing>
            </DrawingImage.Drawing>
        </DrawingImage>

        <DrawingImage x:Key="BerichteIcon">
            <DrawingImage.Drawing>
                <GeometryDrawing Brush="#FFC107">
                    <GeometryDrawing.Geometry>
                        <RectangleGeometry RadiusX="5" RadiusY="5" Rect="0,0,32,32" />
                    </GeometryDrawing.Geometry>
                </GeometryDrawing>
            </DrawingImage.Drawing>
        </DrawingImage>

        <Style x:Key="RightPanelStyle" TargetType="Border">
            <Setter Property="Width" Value="300" />
            <Setter Property="Margin" Value="5,0,10,10" />
            <Setter Property="Background" Value="WhiteSmoke" />
            <Setter Property="BorderBrush" Value="DarkGray" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="5" />
        </Style>

        <Style x:Key="RightPanelStackStyle" TargetType="StackPanel">
            <Setter Property="Margin" Value="10" />
        </Style>

        <Style x:Key="LeftPanelStyle" TargetType="Border">
            <Setter Property="Margin" Value="10,0,5,10" />
            <Setter Property="Background" Value="WhiteSmoke" />
            <Setter Property="BorderBrush" Value="DarkGray" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="5" />
        </Style>

        <Style x:Key="DatePickerStyle" TargetType="DatePicker">
            <Setter Property="Margin" Value="5" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontFamily" Value="{Binding FontFamily}" />
            <Setter Property="FontSize" Value="{Binding FontSize}" />
            <Setter Property="Background" Value="{Binding TextBoxBackgroundColor}" />
            <Setter Property="Foreground" Value="{Binding TextBoxForegroundColor}" />
            <Setter Property="BorderBrush" Value="{Binding TextBoxBorderColor}" />
        </Style>

        <Style x:Key="StandardScrollViewer" TargetType="ScrollViewer">
            <Setter Property="VerticalScrollBarVisibility" Value="Auto" />
            <Setter Property="HorizontalScrollBarVisibility" Value="Auto" />
        </Style>

        <Style x:Key="StandardGroupBox" TargetType="GroupBox">
            <Setter Property="Margin" Value="0,0,0,10" />
            <Setter Property="Padding" Value="5" />
            <Setter Property="Background" Value="{Binding GroupBoxBackgroundColor}" />
            <Setter Property="BorderBrush" Value="{Binding GroupBoxBorderColor}" />
        </Style>

        <Style x:Key="MainTabItem" TargetType="TabItem">
            <Setter Property="Background" Value="{Binding TabItemBackgroundColor}" />
            <Setter Property="Foreground" Value="{Binding TabItemForegroundColor}" />
            <Setter Property="BorderBrush" Value="{Binding TabItemBorderColor}" />
            <Setter Property="FontSize" Value="{Binding TabFontSize}" />
            <Setter Property="Padding" Value="10,5" />
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="{Binding TabItemSelectedBackgroundColor}" />
                    <Setter Property="FontWeight" Value="Bold" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="MainTabControl" TargetType="TabControl">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderBrush" Value="{Binding RahmenColor}" />
        </Style>
    </Window.Resources>
    
    <Grid>
        <TabControl Style="{StaticResource MainTabControl}">
            <!-- Tab 1 with three panels -->
            <TabItem Header="Onboarding" Style="{StaticResource MainTabItem}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="450"/>
                        <ColumnDefinition Width="450"/>
                        <ColumnDefinition Width="350"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Left Panel -->
                    <Border Grid.Column="0" 
                            Background="WhiteSmoke" 
                            BorderBrush="{Binding RahmenColor}" 
                            BorderThickness="1" 
                            CornerRadius="5" 
                            Margin="10">
                        <ScrollViewer Style="{StaticResource StandardScrollViewer}">
                            <StackPanel Margin="10">
                                <GroupBox Header="Benutzerinformationen" Style="{StaticResource StandardGroupBox}">
                                    <Grid>
                                        <!-- Basic Information from MainGUI.xaml -->
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>

                                        <!-- First Name -->
                                        <TextBlock Grid.Row="0" Grid.Column="0" 
                                                  Margin="0,0,5,0" 
                                                  VerticalAlignment="Center" 
                                                  Text="First Name *:" />
                                        <TextBox x:Name="txtFirstName" 
                                                Grid.Row="0" Grid.Column="1" 
                                                Style="{StaticResource RequiredTextBox}" />

                                        <!-- Last Name -->
                                        <TextBlock Grid.Row="1" Grid.Column="0" 
                                                  Margin="0,0,5,0" 
                                                  VerticalAlignment="Center" 
                                                  Text="Last Name *:" />
                                        <TextBox x:Name="txtLastName" 
                                                Grid.Row="1" Grid.Column="1" 
                                                Style="{StaticResource RequiredTextBox}" />

                                        <!-- External Checkbox -->
                                        <TextBlock Grid.Row="2" Grid.Column="0" 
                                                  Margin="0,0,5,0" 
                                                  VerticalAlignment="Center" 
                                                  Text="External?" />
                                        <CheckBox x:Name="chkExternal" 
                                                 Grid.Row="2" Grid.Column="1" 
                                                 VerticalAlignment="Center" />
                                    </Grid>
                                </GroupBox>
                                
                                <GroupBox Header="Anmeldeinformationen" Style="{StaticResource StandardGroupBox}">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>

                                        <!-- Display Name -->
                                        <TextBlock Grid.Row="0" Grid.Column="0" 
                                                  Margin="0,0,5,0" 
                                                  VerticalAlignment="Center" 
                                                  Text="Display Name:" />
                                        <TextBox x:Name="txtDisplayName" 
                                                Grid.Row="0" Grid.Column="1" 
                                                Style="{StaticResource StandardTextBox}" />

                                        <!-- Email Address -->
                                        <TextBlock Grid.Row="1" Grid.Column="0" 
                                                  Margin="0,0,5,0" 
                                                  VerticalAlignment="Center" 
                                                  Text="Email Address:" />
                                        <TextBox x:Name="txtEmail" 
                                                Grid.Row="1" Grid.Column="1" 
                                                Style="{StaticResource StandardTextBox}" />

                                        <!-- Mail Suffix -->
                                        <TextBlock Grid.Row="2" Grid.Column="0" 
                                                  Margin="0,0,5,0" 
                                                  VerticalAlignment="Center" 
                                                  Text="Mail Suffix:" />
                                        <ComboBox x:Name="cmbSuffix" 
                                                 Grid.Row="2" Grid.Column="1" 
                                                 Style="{StaticResource RequiredComboBox}"
                                                 DisplayMemberPath="Value"
                                                 ItemsSource="{Binding MailSuffixListFromINI}"
                                                 SelectedValuePath="Key" />

                                        <!-- Display Template -->
                                        <TextBlock Grid.Row="3" Grid.Column="0" 
                                                  Margin="0,0,5,0" 
                                                  VerticalAlignment="Center" 
                                                  Text="Template:" />
                                        <ComboBox x:Name="cmbDisplayTemplate" 
                                                 Grid.Row="3" Grid.Column="1" 
                                                 Style="{StaticResource StandardComboBox}">
                                            <ComboBoxItem Content="Template1" />
                                            <ComboBoxItem Content="Template2" />
                                        </ComboBox>
                                    </Grid>
                                </GroupBox>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                    
                    <!-- Middle Panel -->
                    <Border Grid.Column="1" 
                            Background="WhiteSmoke" 
                            BorderBrush="{Binding RahmenColor}" 
                            BorderThickness="1" 
                            CornerRadius="5" 
                            Margin="10">
                        <ScrollViewer Style="{StaticResource StandardScrollViewer}">
                            <StackPanel Margin="10">
                                <GroupBox Header="Berechtigungen" Style="{StaticResource StandardGroupBox}">
                                    <StackPanel>
                                        <!-- License Selection -->
                                        <Grid Margin="5">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Margin="0,0,5,0" 
                                                      VerticalAlignment="Center" 
                                                      Text="MS365 License:" />
                                            <ComboBox x:Name="cmbLicense" 
                                                     Grid.Column="1" 
                                                     Style="{StaticResource RequiredComboBox}"
                                                     DisplayMemberPath="Name"
                                                     ItemsSource="{Binding LicenseListFromINI}"
                                                     SelectedValuePath="Value" />
                                        </Grid>
                                        
                                        <!-- Role Assignment -->
                                        <Grid Margin="5">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Margin="0,0,5,0" 
                                                      VerticalAlignment="Center" 
                                                      Text="Roles:" />
                                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                                <CheckBox x:Name="chkTL" 
                                                         Margin="0,0,15,0" 
                                                         Content="Team Lead (TL)" />
                                                <CheckBox x:Name="chkAL" 
                                                         Content="Head of ... (AL)" />
                                            </StackPanel>
                                        </Grid>
                                        
                                        <!-- TL Group Selection -->
                                        <Grid Margin="5">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Margin="0,0,5,0" 
                                                      VerticalAlignment="Center" 
                                                      Text="TL Group:" />
                                            <ComboBox x:Name="cmbTLGroup" 
                                                     Grid.Column="1" 
                                                     Style="{StaticResource StandardComboBox}"
                                                     DisplayMemberPath="Value"
                                                     ItemsSource="{Binding TLGroupOptions}"
                                                     SelectedValuePath="Value" />
                                        </Grid>
                                    </StackPanel>
                                </GroupBox>
                                
                                <GroupBox Header="Softwareausstattung" Style="{StaticResource StandardGroupBox}">
                                    <StackPanel>
                                        <!-- AD Groups Section -->
                                        <TextBlock Margin="5" FontWeight="Bold" Text="AD Groups:" />
                                        <ScrollViewer Height="200" 
                                                     Margin="5" 
                                                     VerticalScrollBarVisibility="Auto" 
                                                     HorizontalScrollBarVisibility="Disabled">
                                            <ItemsControl x:Name="icADGroups" Background="#FFFBFBFB">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <UniformGrid Columns="2" />
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <CheckBox Margin="5" Content="{Binding}" />
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </ScrollViewer>
                                    </StackPanel>
                                </GroupBox>
                                
                                <GroupBox Header="Ger채teausstattung" Style="{StaticResource StandardGroupBox}">
                                    <Grid>
                                        <!-- Account Status -->
                                        <StackPanel>
                                            <TextBlock FontWeight="Bold" Text="AccountStatus" />
                                            <StackPanel Margin="0,5,0,0" Orientation="Horizontal">
                                                <RadioButton x:Name="rbAccountEnabled" 
                                                           Margin="0,0,25,0" 
                                                           Content="Account Enabled" 
                                                           GroupName="AccountStatus" />
                                                <RadioButton x:Name="rbAccountDisabled" 
                                                           Content="Account Disabled" 
                                                           GroupName="AccountStatus" 
                                                           IsChecked="True" />
                                            </StackPanel>
                                            
                                            <!-- Password Options -->
                                            <TextBlock Margin="0,15,0,5" FontWeight="Bold" Text="Password Options" />
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>
                                                
                                                <!-- GENERATED Password -->
                                                <Border Grid.Column="0" 
                                                       Margin="0,0,5,0" 
                                                       BorderBrush="LightGray" 
                                                       BorderThickness="1" 
                                                       CornerRadius="3">
                                                    <StackPanel Margin="5" Background="#FFF9F9F9">
                                                        <TextBlock Margin="0,0,0,5" 
                                                                  FontWeight="Bold" 
                                                                  Text="GENERATED Password" />
                                                        <RadioButton x:Name="rbRand" 
                                                                   Content="Use generated password" 
                                                                   GroupName="PasswordOption" 
                                                                   IsChecked="True" />
                                                        <Grid Margin="20,5,0,0">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto" />
                                                                <ColumnDefinition Width="Auto" />
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Grid.Column="0" Text="Length:" />
                                                            <TextBox x:Name="txtPWLen" 
                                                                    Grid.Column="1" 
                                                                    Width="35" 
                                                                    Text="14" />
                                                        </Grid>
                                                        <CheckBox x:Name="chkIncludeSpecial" 
                                                                 Margin="20,5,0,0" 
                                                                 Content="Special Characters" 
                                                                 IsChecked="True" />
                                                        <CheckBox x:Name="chkAvoidAmbig" 
                                                                 Margin="20,5,0,0" 
                                                                 Content="Avoid Ambiguous Characters" 
                                                                 IsChecked="True" />
                                                    </StackPanel>
                                                </Border>
                                                
                                                <!-- FIXED Password -->
                                                <Border Grid.Column="1" 
                                                       Margin="5,0,0,0" 
                                                       BorderBrush="LightGray" 
                                                       BorderThickness="1" 
                                                       CornerRadius="3">
                                                    <StackPanel Margin="5" Background="#FFF9F9F9">
                                                        <TextBlock Margin="0,0,0,5" 
                                                                  FontWeight="Bold" 
                                                                  Text="FIXED Password" />
                                                        <RadioButton x:Name="rbFix" 
                                                                   Content="Use fixed password" 
                                                                   GroupName="PasswordOption" />
                                                        <TextBox x:Name="txtFixPW" 
                                                                Margin="0,25,0,0" 
                                                                IsEnabled="{Binding IsChecked, ElementName=rbFix}" />
                                                    </StackPanel>
                                                </Border>
                                            </Grid>
                                        </StackPanel>
                                    </Grid>
                                </GroupBox>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                    
                    <!-- Right Panel -->
                    <Border Grid.Column="2" 
                            Background="WhiteSmoke" 
                            BorderBrush="{Binding RahmenColor}" 
                            BorderThickness="1" 
                            CornerRadius="5" 
                            Margin="10">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Logo Area -->
                            <Border Grid.Row="0" 
                                    Background="#FBFBFB" 
                                    BorderBrush="{Binding RahmenColor}" 
                                    BorderThickness="0,0,0,1" 
                                    Padding="10">
                                <Image Source="{Binding HeaderLogo1}" Height="80" HorizontalAlignment="Center"/>
                            </Border>
                            
                            <!-- Status Area -->
                            <ScrollViewer Grid.Row="1" Style="{StaticResource StandardScrollViewer}">
                                <StackPanel Margin="10">
                                    <GroupBox Header="Status" Style="{StaticResource StandardGroupBox}">
                                        <StackPanel>
                                            <!-- UPN Template Section -->
                                            <Border Height="50" Background="#F7F7F7F7" Margin="0,0,0,10">
                                                <StackPanel>
                                                    <TextBlock Width="190" 
                                                              Margin="0,5,0,0" 
                                                              HorizontalAlignment="Left" 
                                                              FontWeight="Bold" 
                                                              Text="UPN Template:" />
                                                    <TextBlock x:Name="txtUPNTemplateDisplay" 
                                                              Width="190" 
                                                              Margin="0,5,0,0" 
                                                              HorizontalAlignment="Center" 
                                                              Text="{Binding DefaultUserPrincipalNameFormat}" 
                                                              TextAlignment="Center" />
                                                </StackPanel>
                                            </Border>
                                            
                                            <!-- Progress & Status -->
                                            <ProgressBar x:Name="progressBar" 
                                                        Height="20" 
                                                        Margin="0,5,0,5" 
                                                        Maximum="100" 
                                                        Minimum="0" 
                                                        Value="0" />
                                            <TextBlock x:Name="lblStatus" 
                                                      HorizontalAlignment="Center" 
                                                      Text="Ready..." />
                                            
                                            <!-- Document Options -->
                                            <TextBlock Margin="0,10,0,5" 
                                                      HorizontalAlignment="Center" 
                                                      FontWeight="Bold" 
                                                      Text="Documents:" />
                                            <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                                <CheckBox x:Name="chkHTML" 
                                                         Margin="5" 
                                                         Content="HTML" 
                                                         IsChecked="True" />
                                                <CheckBox x:Name="chkTXT" 
                                                         Margin="5" 
                                                         Content="TXT" />
                                                <CheckBox x:Name="chkPDF" 
                                                         Margin="5" 
                                                         Content="PDF" />
                                            </StackPanel>
                                        </StackPanel>
                                    </GroupBox>
                                </StackPanel>
                            </ScrollViewer>
                            
                            <!-- Action Buttons -->
                            <StackPanel Grid.Row="2" Margin="10">
                                <Button x:Name="btnOnboard" 
                                       Content="Benutzer anlegen" 
                                       Style="{StaticResource ActionButton}" 
                                       Background="LightGreen"
                                       Margin="5,5,5,10"/>
                                <Button x:Name="btnProxyMail" 
                                       Content="Set proxyAddresses" 
                                       Style="{StaticResource ActionButton}" 
                                       Background="LightYellow"
                                       Margin="5,0,5,10"/>
                                <Button x:Name="btnClearPreview" 
                                       Content="Zur체cksetzen" 
                                       Style="{StaticResource ActionButton}" 
                                       Background="LightGray"
                                       Margin="5,0,5,10"/>
                                <Button x:Name="btnClose" 
                                       Content="Beenden" 
                                       Style="{StaticResource ActionButton}" 
                                       Background="LightCoral"
                                       Margin="5,0,5,5"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>
            
            <!-- Tab 2 with two panels -->
            <TabItem Header="Einstellungen" Style="{StaticResource MainTabItem}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="900"/>
                        <ColumnDefinition Width="350"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Left Panel -->
                    <Border Grid.Column="0" 
                            Background="WhiteSmoke" 
                            BorderBrush="{Binding RahmenColor}" 
                            BorderThickness="1" 
                            CornerRadius="5" 
                            Margin="10">
                        <ScrollViewer Style="{StaticResource StandardScrollViewer}">
                            <StackPanel Margin="10">
                                <GroupBox Header="Systemeinstellungen" Style="{StaticResource StandardGroupBox}">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <!-- Default AD Domain -->
                                        <TextBlock Grid.Row="0" Grid.Column="0" 
                                                  Margin="5" 
                                                  VerticalAlignment="Center" 
                                                  Text="Default AD Domain:" />
                                        <TextBox Grid.Row="0" Grid.Column="1" 
                                                Margin="5" 
                                                Style="{StaticResource StandardTextBox}" />
                                        
                                        <!-- Default OU Path -->
                                        <TextBlock Grid.Row="1" Grid.Column="0" 
                                                  Margin="5" 
                                                  VerticalAlignment="Center" 
                                                  Text="Default OU Path:" />
                                        <TextBox Grid.Row="1" Grid.Column="1" 
                                                Margin="5" 
                                                Style="{StaticResource StandardTextBox}" />
                                        
                                        <!-- Report Path -->
                                        <TextBlock Grid.Row="2" Grid.Column="0" 
                                                  Margin="5" 
                                                  VerticalAlignment="Center" 
                                                  Text="Report Path:" />
                                        <Grid Grid.Row="2" Grid.Column="1">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <TextBox Grid.Column="0" 
                                                    Margin="5" 
                                                    Style="{StaticResource StandardTextBox}" />
                                            <Button Grid.Column="1" 
                                                   Content="Browse..." 
                                                   Width="80" 
                                                   Margin="5" />
                                        </Grid>
                                        
                                        <!-- Theme Selection -->
                                        <TextBlock Grid.Row="3" Grid.Column="0" 
                                                  Margin="5" 
                                                  VerticalAlignment="Center" 
                                                  Text="Theme:" />
                                        <ComboBox Grid.Row="3" Grid.Column="1" 
                                                 Margin="5" 
                                                 Style="{StaticResource StandardComboBox}">
                                            <ComboBoxItem Content="Light" />
                                            <ComboBoxItem Content="Dark" />
                                            <ComboBoxItem Content="System" />
                                        </ComboBox>
                                    </Grid>
                                </GroupBox>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                    
                    <!-- Right Panel -->
                    <Border Grid.Column="1" 
                            Background="WhiteSmoke" 
                            BorderBrush="{Binding RahmenColor}" 
                            BorderThickness="1" 
                            CornerRadius="5" 
                            Margin="10">
                        <ScrollViewer Style="{StaticResource StandardScrollViewer}">
                            <StackPanel Margin="10">
                                <GroupBox Header="Benachrichtigungen" Style="{StaticResource StandardGroupBox}">
                                    <StackPanel>
                                        <!-- Email Notifications -->
                                        <CheckBox Content="Enable Email Notifications" 
                                                 Margin="5" 
                                                 IsChecked="True" />
                                        
                                        <!-- Email Settings -->
                                        <Grid Margin="20,5,5,5">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            
                                            <!-- SMTP Server -->
                                            <TextBlock Grid.Row="0" Grid.Column="0" 
                                                      Margin="0,0,5,0" 
                                                      VerticalAlignment="Center" 
                                                      Text="SMTP Server:" />
                                            <TextBox Grid.Row="0" Grid.Column="1" 
                                                    Margin="5" 
                                                    Style="{StaticResource StandardTextBox}" />
                                            
                                            <!-- From Address -->
                                            <TextBlock Grid.Row="1" Grid.Column="0" 
                                                      Margin="0,0,5,0" 
                                                      VerticalAlignment="Center" 
                                                      Text="From Address:" />
                                            <TextBox Grid.Row="1" Grid.Column="1" 
                                                    Margin="5" 
                                                    Style="{StaticResource StandardTextBox}" />
                                            
                                            <!-- Admin Email -->
                                            <TextBlock Grid.Row="2" Grid.Column="0" 
                                                      Margin="0,0,5,0" 
                                                      VerticalAlignment="Center" 
                                                      Text="Admin Email:" />
                                            <TextBox Grid.Row="2" Grid.Column="1" 
                                                    Margin="5" 
                                                    Style="{StaticResource StandardTextBox}" />
                                        </Grid>
                                        
                                        <!-- Notification Types -->
                                        <GroupBox Header="Notification Types" 
                                                 Margin="5,15,5,5" 
                                                 Style="{StaticResource StandardGroupBox}">
                                            <StackPanel>
                                                <CheckBox Content="User Created" 
                                                         Margin="5" 
                                                         IsChecked="True" />
                                                <CheckBox Content="User Modified" 
                                                         Margin="5" 
                                                         IsChecked="True" />
                                                <CheckBox Content="Error Notifications" 
                                                         Margin="5" 
                                                         IsChecked="True" />
                                            </StackPanel>
                                        </GroupBox>
                                    </StackPanel>
                                </GroupBox>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </TabItem>
            
            <!-- Tab 3 with two panels -->
            <TabItem Header="Berichte" Style="{StaticResource MainTabItem}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="900"/>
                        <ColumnDefinition Width="350"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Left Panel -->
                    <Border Grid.Column="0" 
                            Background="WhiteSmoke" 
                            BorderBrush="{Binding RahmenColor}" 
                            BorderThickness="1" 
                            CornerRadius="5" 
                            Margin="10">
                        <ScrollViewer Style="{StaticResource StandardScrollViewer}">
                            <StackPanel Margin="10">
                                <GroupBox Header="Berichte" Style="{StaticResource StandardGroupBox}">
                                    <Grid>
                                        <!-- Report Type Selection -->
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>
                                        
                                        <!-- Report Type Selector -->
                                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="5">
                                            <TextBlock Text="Report Type:" 
                                                      VerticalAlignment="Center" 
                                                      Margin="0,0,10,0" />
                                            <ComboBox Width="200" Style="{StaticResource StandardComboBox}">
                                                <ComboBoxItem Content="User Activity" />
                                                <ComboBoxItem Content="Recent Onboardings" />
                                                <ComboBoxItem Content="License Usage" />
                                                <ComboBoxItem Content="Custom Report" />
                                            </ComboBox>
                                        </StackPanel>
                                        
                                        <!-- Date Range -->
                                        <Grid Grid.Row="1" Margin="5,15,5,5">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Grid.Column="0" 
                                                      Text="Start Date:" 
                                                      VerticalAlignment="Center" 
                                                      Margin="0,0,5,0" />
                                            <DatePicker Grid.Column="1" 
                                                       Style="{StaticResource DatePickerStyle}" 
                                                       Margin="0,0,20,0" />
                                            
                                            <TextBlock Grid.Column="2" 
                                                      Text="End Date:" 
                                                      VerticalAlignment="Center" 
                                                      Margin="0,0,5,0" />
                                            <DatePicker Grid.Column="3" 
                                                       Style="{StaticResource DatePickerStyle}" />
                                        </Grid>
                                        
                                        <!-- Report Data Display -->
                                        <DataGrid Grid.Row="2" 
                                                 Margin="5,15,5,5" 
                                                 Height="400" 
                                                 Style="{StaticResource DataGridStyle}"
                                                 AutoGenerateColumns="True">
                                        </DataGrid>
                                    </Grid>
                                </GroupBox>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                    
                    <!-- Right Panel -->
                    <Border Grid.Column="1" 
                            Background="WhiteSmoke" 
                            BorderBrush="{Binding RahmenColor}" 
                            BorderThickness="1" 
                            CornerRadius="5" 
                            Margin="10">
                        <ScrollViewer Style="{StaticResource StandardScrollViewer}">
                            <StackPanel Margin="10">
                                <GroupBox Header="Export" Style="{StaticResource StandardGroupBox}">
                                    <StackPanel>
                                        <!-- Export Options -->
                                        <TextBlock Text="Export Format:" 
                                                  Margin="5,5,5,10" 
                                                  FontWeight="Bold" />
                                        
                                        <RadioButton Content="PDF" 
                                                    Margin="10,5,5,5" 
                                                    GroupName="ExportFormat" 
                                                    IsChecked="True" />
                                        <RadioButton Content="Excel" 
                                                    Margin="10,5,5,5" 
                                                    GroupName="ExportFormat" />
                                        <RadioButton Content="CSV" 
                                                    Margin="10,5,5,5" 
                                                    GroupName="ExportFormat" />
                                        <RadioButton Content="HTML" 
                                                    Margin="10,5,5,5" 
                                                    GroupName="ExportFormat" />
                                        
                                        <!-- Extra Options -->
                                        <CheckBox Content="Include Charts" 
                                                 Margin="5,15,5,5" 
                                                 IsChecked="True" />
                                        <CheckBox Content="Include Metadata" 
                                                 Margin="5,5,5,5" 
                                                 IsChecked="True" />
                                        
                                        <!-- Export Path -->
                                        <Grid Margin="5,15,5,5">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            
                                            <TextBlock Grid.Row="0" 
                                                      Text="Export Path:" 
                                                      Margin="0,0,0,5" />
                                            
                                            <Grid Grid.Row="1">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                
                                                <TextBox Grid.Column="0" 
                                                        Style="{StaticResource StandardTextBox}" />
                                                <Button Grid.Column="1" 
                                                       Content="..." 
                                                       Width="30" 
                                                       Margin="5,0,0,0" />
                                            </Grid>
                                        </Grid>
                                        
                                        <!-- Action Buttons -->
                                        <Button Content="Generate Report" 
                                               Margin="5,20,5,5" 
                                               Height="40" 
                                               Background="LightGreen" />
                                        <Button Content="Reset Filters" 
                                               Margin="5,10,5,5" 
                                               Height="40" 
                                               Background="LightGray" />
                                    </StackPanel>
                                </GroupBox>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
